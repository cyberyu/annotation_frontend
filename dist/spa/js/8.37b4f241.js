(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{d556:function(e,t,o){"use strict";o.r(t);var a,s,i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("q-page",{staticClass:"flex"},[o("div",{staticClass:"row col-12 self-start"},[o("q-breadcrumbs",[o("q-breadcrumbs-el",{attrs:{label:"My Projects",icon:"home",to:"/"}}),o("q-breadcrumbs-el",{attrs:{label:"Project Summary",icon:"widgets"}})],1)],1),o("div",{staticClass:"flex row fit justify-center flex-center"},[e.project.id?o("q-card",{staticStyle:{"max-width":"450px"}},[o("q-card-section",[o("div",{staticClass:"text-h6"},[e._v(e._s(e.project.name))]),o("div",{staticClass:"text-capitalize text-grey"},[e._v("\n          "+e._s(e.project.description)+"\n        ")])]),o("q-separator"),o("q-card-section",[o("q-linear-progress",{attrs:{size:"25px",value:e.project.num_of_annotated_docs/e.project.num_of_docs,color:"accent"}},[o("div",{staticClass:"absolute-full flex flex-center"},[o("q-badge",{attrs:{color:"white","text-color":"accent",label:(e.project.num_of_annotated_docs/e.project.num_of_docs*100).toFixed(2)+"% ("+e.project.num_of_annotated_docs+"/"+e.project.num_of_docs+")"}})],1)]),o("div",{staticClass:"flex justify-center"},e._l(e.project.labels,(function(t,a){return o("q-btn",{key:a,staticClass:"q-mr-xs q-my-sm",style:"color: "+t.color,attrs:{outline:"",size:"sm"}},[e._v("\n            "+e._s(t.name)+"\n          ")])})),1),e.project.curators?o("div",[e._v("curators: "+e._s(e.project.curators.length))]):e._e(),e.project.vmodels?o("div",[e._v("models: "+e._s(e.project.vmodels.length))]):e._e(),e.project.rules?o("div",[e._v("rules: "+e._s(e.project.rules.length))]):e._e(),e.project.dicts?o("div",[e._v("dictionaries: "+e._s(e.project.dicts.length))]):e._e(),e.project.cmodels?o("div",[e._v("consensus model: "+e._s(e.project.cmodels.length))]):e._e(),e.project.id&&e.canReview?o("div",{staticClass:"flex justify-start q-mt-sm"},[o("q-btn",{staticStyle:{"font-size":"12px"},attrs:{label:"Upload documents",color:"primary"},on:{click:function(t){e.upload=!0}}}),o("q-btn",{staticClass:"q-mx-sm",staticStyle:{"font-size":"12px"},attrs:{label:"Export curation data",color:"primary",loading:e.loading},on:{click:function(t){return e.downloadLabel()}}})],1):e._e(),e.fileInfo?o("div",[o("a",{attrs:{href:"cache/"+e.fileInfo.text}},[e._v("download texts ")]),o("a",{staticClass:"q-mx-sm",attrs:{href:"cache/"+e.fileInfo.label}},[e._v("download labels ")])]):e._e(),o("q-dialog",{model:{value:e.upload,callback:function(t){e.upload=t},expression:"upload"}},[o("q-card",[o("q-card-section",[o("axios-uploader",{staticStyle:{"max-width":"300px"},attrs:{url:e.$hostname+"/api/upload/","form-fields":[{name:"project",value:e.project.id},{name:"user",value:e.loggedInUser.id}],flat:"",bordered:"",method:"put"},on:{uploaded:e.uploaded}}),e.numOfUploaded?o("span",{staticClass:"q-pa-sm text-positive"},[e._v(e._s(e.numOfUploaded)+" docs uploaded")]):e._e()],1),o("q-card-actions",{attrs:{align:"right"}},[o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"OK",color:"primary"},on:{click:function(t){e.numOfUploaded=null}}})],1)],1)],1)],1),o("q-card-actions",{attrs:{align:"right"}},[e.project.id&&e.canReview&&e.project.cmodels.length>0?o("q-btn",{attrs:{flat:"",disable:0===e.project.number_of_docs},on:{click:function(t){e.$router.push({name:"annotate",params:{project:e.project,consensus:!0}}),e.$emit("mode","Concensus")}}},[e._v("\n          Check Consensus\n        ")]):e._e(),e.project.id&&e.canReview?o("q-btn",{attrs:{flat:"",disable:0===e.project.number_of_docs},on:{click:function(t){e.$router.push({name:"annotate",params:{project:e.project,review:!0}}),e.$emit("mode","Review")}}},[e._v("\n          Review\n        ")]):e._e(),o("q-btn",{attrs:{flat:"",disable:0===e.project.number_of_docs},on:{click:function(t){e.$router.push({name:"annotate",params:{project:e.project,review:!1}}),e.$emit("mode","Annotate")}}},[e._v("\n          Annotate It\n        ")])],1)],1):o("div",[e._v("\n      Loading project detail\n    ")])],1)])},r=[],l=o("2b0e"),n=o("3a82"),d=o("f259"),c=l["a"].extend({name:"AxiosUploader",mixins:[n["a"],d["a"]],methods:{upload(){if(!1===this.canUpload)return;const e=this.queuedFiles.slice(0);this.queuedFiles=[],console.log(this);const t={url:this.url,method:this.method,headers:this.headers,formFields:this.formFields};console.log(t),e.forEach((e=>{this.workingThreads++,this.uploadFiles([e],t)}))},uploadFiles(e,t){const o=new FormData,a={};t.headers&&t.headers.forEach((e=>{a[e.name]=e.value})),t.formFields&&t.formFields.forEach((e=>{o.append(e.name,e.value)})),o.append(t.fieldName,e[0],e[0].name);let s,i=0,r=0,l=0,n=0;const d=this.$axios({url:t.url,method:t.method,data:o,headers:a,onUploadProgress:t=>{if(!0===s)return;const o=Math.min(n,t.loaded);this.uploadedSize+=o-l,l=o;let a=l-r;for(let s=i;a>0&&s<e.length;s++){const t=e[s],o=a>t.size;if(!o)return void this.__updateFile(t,"uploading",a);a-=t.size,i++,r+=t.size,this.__updateFile(t,"uploading",t.size)}}});this.xhrs.push(d),this.$emit("uploading",{files:e,xhr:d}),d.then((t=>{this.uploadedFiles=this.uploadedFiles.concat(e),e.forEach((e=>{this.__updateFile(e,"uploaded")})),this.$emit("uploaded",{files:e,xhr:d})})).catch((t=>{console.log(t),s=!0,this.uploadedSize-=l,this.queuedFiles=this.queuedFiles.concat(e),e.forEach((e=>{this.__updateFile(e,"failed")})),this.$emit("failed",{files:e,xhr:d})})).finally((()=>{this.workingThreads--,this.xhrs=this.xhrs.filter((e=>e!==d))})),e.forEach((e=>{this.__updateFile(e,"uploading",0),e.xhr=d,e.__abort=()=>{d.abort()},n+=e.size})),this.$emit("uploading",{files:e,xhr:d}),this.xhrs.push(d)}}}),p=c,u=o("2877"),h=Object(u["a"])(p,a,s,!1,null,"63615562",null),m=h.exports,f={name:"projectDetail",components:{AxiosUploader:m},data(){return{project:{},upload:!1,download:!1,loading:!1,fileInfo:null,numOfUploaded:null}},mounted(){const e=this.$route.params.id;this.$emit("mode",null),this.fetchProject(e)},methods:{fetchProject(e){this.$axios.get(this.$hostname+`/api/projects/${e}/`).then((e=>{this.project=e.data}))},uploadFile(e){return new Promise((e=>{setTimeout((()=>{e({})}),2e3)}))},uploaded(e){e.xhr.then((e=>{this.numOfUploaded=e.data.total,this.project.num_of_docs+=this.numOfUploaded,this.$forceUpdate()}))},downloadLabel(){this.loading=!0,this.$axios.get(`/api/projects/${this.project.id}/download/`).then((e=>{this.fileInfo=e.data,this.loading=!1}))}},computed:{canReview(){return this.project.admins.includes(this.loggedInUser.id)},loggedInUser(){return this.$store.getters["auth/user"]}}},_=f,j=o("9989"),v=o("ead5"),b=o("079e"),g=o("f09f"),x=o("a370"),q=o("eb85"),w=o("6b1d"),$=o("58a81"),F=o("9c40"),C=o("24e8"),y=o("4b7e"),U=o("7f67"),k=o("eebe"),z=o.n(k),Q=Object(u["a"])(_,i,r,!1,null,"32448848",null);t["default"]=Q.exports;z()(Q,"components",{QPage:j["a"],QBreadcrumbs:v["a"],QBreadcrumbsEl:b["a"],QCard:g["a"],QCardSection:x["a"],QSeparator:q["a"],QLinearProgress:w["a"],QBadge:$["a"],QBtn:F["a"],QDialog:C["a"],QCardActions:y["a"]}),z()(Q,"directives",{ClosePopup:U["a"]})}}]);